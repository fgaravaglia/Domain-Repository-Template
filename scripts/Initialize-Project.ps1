# Script per inizializzare il tipo di repository

Clear-Host

# --- Splash Screen ---
$foregroundColor = "Cyan"
if ($Host.Name -eq 'Windows PowerShell ISE') {
    # L'ISE non supporta tutti i colori, usiamo un colore sicuro
    $foregroundColor = "Cyan"
}

$art = @"
                                                                                                    
    ██╗   ██╗███╗   ███╗██████╗ ███████╗███████╗██╗     ██╗      ██████╗██╗      
    ██║   ██║████╗ ████║██╔══██╗██╔════╝██╔════╝██║     ██║      ██╔══██╗██║      
    ██║   ██║██╔████╔██║██████╔╝█████╗  █████╗  ██║     ██║      ██║  ██║██║      
    ██║   ██║██║╚██╔╝██║██╔══██╗██╔══╝  ██╔══╝  ██║     ██║      ██║  ██║██║      
    ╚██████╔╝██║ ╚═╝ ██║██║  ██║███████╗███████╗███████╗███████╗ ██████╔╝███████╗ 
     ╚═════╝ ╚═╝     ╚═╝╚═╝  ╚═╝╚══════╝╚══════╝╚══════╝╚══════╝ ╚═════╝ ╚══════╝ 
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          t"@
Write-Host $art -ForegroundColor $foregroundColor
Start-Sleep -Seconds 2
# --- Fine Splash Screen ---


# Definisce le scelte per l'utente
$title = "Selezione del Tipo di Repository"
$message = "Scegli il tipo di progetto che vuoi configurare. Questa azione sposterà il file README corretto nella root del progetto."

$choices = [System.Management.Automation.Host.ChoiceDescription[]](
    New-Object System.Management.Automation.Host.ChoiceDescription("&Microservizio", "Configura il repository per un microservizio."),
    New-Object System.Management.Automation.Host.ChoiceDescription("&Libreria", "Configura il repository per una libreria.")
)

# Mostra il prompt all'utente
$choiceIndex = $Host.UI.PromptForChoice($title, $message, $choices, 0)

# Determina il percorso root del progetto basandosi sulla posizione dello script
$scriptDir = $PSScriptRoot
$projectRoot = Resolve-Path (Join-Path $scriptDir "..")

# Imposta i file di origine
$sourceFiles = @{
    "Microservizio" = "gemini-microservice.md";
    "Libreria"      = "gemini-library.md";
}

# Esegue l'azione in base alla scelta
switch ($choiceIndex) {
    0 {
        $selection = "Microservizio"
        $sourceFileName = $sourceFiles[$selection]
    }
    1 {
        $selection = "Libreria"
        $sourceFileName = $sourceFiles[$selection]
    }
    default {
        Write-Warning "Selezione non valida. Nessuna azione eseguita."
        exit
    }
}

Write-Host "Hai selezionato: $selection"

# Definisce i percorsi completi
$sourceFilePath = Join-Path $projectRoot "docs" "gemini" $sourceFileName
$destinationFilePath = Join-Path $projectRoot "gemini.md"

# Controlla se il file di origine esiste
if (-not (Test-Path $sourceFilePath)) {
    Write-Error "ERRORE: Il file di origine '$sourceFilePath' non è stato trovato."
    exit
}

# Copia e rinomina il file
try {
    Copy-Item -Path $sourceFilePath -Destination $destinationFilePath -Force -ErrorAction Stop
    Write-Host "Operazione completata con successo."
    Write-Host "File '$sourceFileName' copiato in '$destinationFilePath'."
}
catch {
    Write-Error "Si è verificato un errore durante la copia del file: $_"
}
